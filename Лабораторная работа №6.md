# Отчет по лабораторной работе №6
## Информационная безопасность
### Нгуен Фыок Дат

**1 Цель работы**
• Развить навыки администрирования ОС Linux
• Получить первое практическое знакомство с технологией SELinux
• Проверить работу SELinx на практике совместно с веб-сервером Apache.

**2 Задание**
• Поиск информации про веб-сервер
• Работа с Html-файлами
• Просмотр лог-файлов

*3 Теоретическое введение*

SELinux представляет собой систему маркировки, каждый процесс файл, каталог,
пользователь, устройство, порт и так далее имеет метку. SELinux определяет правила
доступа процесса к объектам с определенными метками. Это называется политикой.
Владелец файла не имеет полной свободы действий над атрибутами безопасности.
Стандартные атрибуты контроля доступа, такие как группа и владелец ничего не значат для SELinux. Полностью все управляется метками. Значения атрибутов могут быть
установлены и без прав root, но на это нужно иметь специальные полномочия SELinux.
SELinux может работать в трех режимах — отключен, система полностью отключена и
не работает, режим ограничений Enforcing — программа активирована и блокирует все не
соответствующие политикам действия и третий режим Permissive — только фиксировать
нарушения.
Политики SELinux бывают тоже нескольких типов. Политика targeted относится к типу
Type Enforcment (TE) политик, в которых управление доступом к файлам осуществляется
на основе ролей. Сюда же относится политика strict. Есть ещё политики Multi-Level
Security (MLS), в которых добавлены дополнительные категории.
Более подробно о см. в [1,2].

**4 Выполнение лабораторной работы**

В качестве первого шага лабораторной работы мы проверили режим работы SELinux с помощью команд getenforce и sestatus (рис. 4.1)

![3](https://github.com/pdat278/lab06-info-secu/assets/83130956/600d4468-3785-4efe-9907-3e93f1f8c462)

Рис. 4.1: Проверка режима работы

Далее мы проверили, работает ли веб-сервер (рис. 4.2), и запустили его, так как он не работал (рис. 4.3).

![4](https://github.com/pdat278/lab06-info-secu/assets/83130956/fe66a4e8-5e54-455a-bee6-e3042691eb73)

Рис. 4.2: Проверка работы веб-сервера

![5](https://github.com/pdat278/lab06-info-secu/assets/83130956/bf1bd65c-fe46-4de9-9c8a-2800ef6ebb3f)
Рис. 4.3: Запуск веб-сервера

Определили контекст безопасности процесса веб-сервера (рис. 4.4). Главной информацией для нас стал тип процесса —httpd_t.

![6](https://github.com/pdat278/lab06-info-secu/assets/83130956/4cc06063-f3d8-4418-b9f5-850c57f6ff15)

Рис. 4.4: Определение контекста безопасности

Посмотрели текущее положение переключателей SELinux, большинство из них находятся в выключенном состоянии (рис. 4.5).

![7](https://github.com/pdat278/lab06-info-secu/assets/83130956/1f0f4829-183d-4957-b118-3a3db76b7ba8)

Рис. 4.5: Просмотр переключателей

Посмотрели статистику по политике с помощью seinfo (рис. 4.6). Определили, что множество пользователей имеет размер 8, множество ролей — 14, а множество типов — 5100.

![8](https://github.com/pdat278/lab06-info-secu/assets/83130956/b81ab30b-4be7-4fda-af7f-f7466b35b46a)

Рис. 4.6: Статистика по политике
Определили тип файлов и поддиректорий директории /var/www (рис. 4.7). Поддиректория cgi-bin имеет тип httpd_sys_script_exec_t, а html — httpd_sys_content_t. Только пользователь-владелец имеет право создавать файлы в папке html.

![9](https://github.com/pdat278/lab06-info-secu/assets/83130956/4a7de50f-38c8-4fe8-82b3-394cdba0ce90)

Рис. 4.7: Определение типов поддиректорий
Создали файл test.html в папке html от лица суперпользователя (рис. 4.8).

![10](https://github.com/pdat278/lab06-info-secu/assets/83130956/759d2287-56de-479d-af54-43749353a52c)

Рис. 4.8: Создание файла test.html

Проверили его контекст (рис. 4.9). Вновь созданным файлам в папке html по умолчанию присваивается тип httpd_sys_content_t.

![11](https://github.com/pdat278/lab06-info-secu/assets/83130956/a56655db-7cba-45c2-9d67-dc7e79be7669)

Рис. 4.9: Проверка контекста test.html

Обратились к файлу через веб-сервер и увидели его содержимое (рис. 4.10).

![test](https://github.com/pdat278/lab06-info-secu/assets/83130956/4db3ec79-b323-4ef3-a763-d63185fe2cd6)

Рис. 4.10: Просмотр файла в браузере
Снова проверили контекст файла и поменяли его на другой (рис. 4.11). Новый контекст файла не позволяет процессу httpd получить доступ к файлу при обращении к нему через браузер.

![12](https://github.com/pdat278/lab06-info-secu/assets/83130956/4f8acb50-3e90-4ac9-9c58-ff618da2c22b)

Рис. 4.11: Смена контекста

Попробовали открыть файл в браузере (рис. 4.12). Возникла ошибка из-за нового
контекста.

![test2](https://github.com/pdat278/lab06-info-secu/assets/83130956/462fc54e-790b-4c38-8866-bd9941ea13bb)

Рис. 4.12: Просмотр файла в браузере
Посмотрели лог-файлы (рис. 4.13). Увидели запись о неудачной попытке браузера получить доступ к файлу (ошибка 403).

![13](https://github.com/pdat278/lab06-info-secu/assets/83130956/586fa71c-993e-42b5-9895-d5fda48bd4ae)

Рис. 4.13: Чтение лог-файлов
Изменили порт в конфигурационном файле httpd.conf с 80 на 81 (рис. 4.14).

![1](https://github.com/pdat278/lab06-info-secu/assets/83130956/1d45174d-f018-46bb-abc4-63bcd4d3e4f4)

Рис. 4.14: Смена порта
Перезапустили веб-сервер, получили сообщение о том, что он запущен на прослушивание 81 порта (рис. 4.15).

![14](https://github.com/pdat278/lab06-info-secu/assets/83130956/3010cfa0-02c9-408b-9d1f-35db710d8dd7)

Рис. 4.15: Перезапуск веб-сервера
Проверили лог-файлы и нашли информацию о переключении веб-сервера на прослушивание нового порта (рис. 4.16)

![15](https://github.com/pdat278/lab06-info-secu/assets/83130956/01b4ddf0-f1ff-49ae-b0e6-98f84d17d315)

Рис. 4.16: Проверка лог-файлов
Посмотрели список портов веб-сервера, нашли там указанный нами порт (рис. 4.17).

![16](https://github.com/pdat278/lab06-info-secu/assets/83130956/e46d7614-e45e-4fe9-bc0d-58326c7aa1d1)

Рис. 4.17: Просмотр списка портов
Вернули файлу test.html старый контекст (рис. 4.18).

![17](https://github.com/pdat278/lab06-info-secu/assets/83130956/4bb6253d-d8b2-450f-9cf6-853aedcc1dc6)

Рис. 4.18: Смена контекста
Получили доступ к файлу через веб-сервер в браузере (рис. 4.19).

![test3](https://github.com/pdat278/lab06-info-secu/assets/83130956/8856db9d-f13e-485d-a727-ddc2b3827420)

Рис. 4.19: Просмотр файла
Вернули порт 80 в конфигурационном файле (рис. 4.20).

![2](https://github.com/pdat278/lab06-info-secu/assets/83130956/e45bad41-bf0b-4371-bab0-26c8af8d7fad)

Рис. 4.20: Изменение порта
Попытались удалить 81 порт, но столкнулись с ошибкой, что он определен на уровне политики и не может быть удален (рис. 4.21). После этого удалили файл test.html.

![18](https://github.com/pdat278/lab06-info-secu/assets/83130956/1e8e8b48-b215-4870-9acb-646d26fc71cc)

Рис. 4.21: Попытка удаления порта

**5 Выводы**
В результате лабораторной работы я получила базовые навыки администрирования ОС Linux, познакомилась с технологией SELinux и проверила ее работу на практике совместно с веб-сервером Apache.





